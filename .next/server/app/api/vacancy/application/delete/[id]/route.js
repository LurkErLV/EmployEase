"use strict";(()=>{var e={};e.id=859,e.ids=[859],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},76559:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>v,originalPathname:()=>f,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>y,staticGenerationAsyncStorage:()=>x,staticGenerationBailout:()=>w});var r={};a.r(r),a.d(r,{DELETE:()=>u});var i=a(95419),s=a(69108),n=a(99678),o=a(23106),l=a(78070),p=a(81355),c=a(83411);async function u(e,{params:t}){let a=await (0,p.getServerSession)(c.L);if(!a)return l.Z.json({ok:!1,message:"You are unauthorized"},{status:401});let r=await o.Z.application.findFirst({where:{id:parseInt(t.id)}}).finally(()=>{o.Z.$disconnect()});return r?r.userId.toString()!==a.user.id.toString()?l.Z.json({ok:!1,message:"User is not owner of application"},{status:403}):(await o.Z.application.delete({where:{id:parseInt(t.id)}}).catch(e=>console.log(e)).finally(()=>{o.Z.$disconnect()}),l.Z.json({ok:!0,message:"Apply successfully deleted"},{status:200})):l.Z.json({ok:!1,message:"Apply not found"},{status:404})}let d=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/vacancy/application/delete/[id]/route",pathname:"/api/vacancy/application/delete/[id]",filename:"route",bundlePath:"app/api/vacancy/application/delete/[id]/route"},resolvedPagePath:"/Users/lurker/Desktop/employease/app/api/vacancy/application/delete/[id]/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:y,headerHooks:v,staticGenerationBailout:w}=d,f="/api/vacancy/application/delete/[id]/route";function g(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:x})}},83411:(e,t,a)=>{a.d(t,{L:()=>n});var r=a(86485),i=a(23106),s=a(6521);let n={secret:process.env.AUTH_SECRET,session:{strategy:"jwt"},providers:[(0,r.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"text"},password:{label:"Password",type:"password"}},async authorize(e,t){if(!e)return;let{email:a,password:r}=e,n=await i.Z.user.findFirst({where:{email:a},include:{application:!0,vacancies:!0}}).finally(()=>{i.Z.$disconnect()});if(!n)throw Error("User not found!");if(!await (0,s.compare)(r,n.password))throw Error("Incorrect password");return{id:n.id,email:n.email,name:n.name,surname:n.surname,role:n.Role,application:n.application,vacancies:n.vacancies}}})],pages:{signIn:`${process.env.BASE_PATH}/auth/signin`,newUser:process.env.BASE_PATH},callbacks:{jwt:async({token:e})=>e,session:async({session:e,token:t})=>{if(!t.email)return null;let a=await i.Z.user.findFirst({where:{email:t.email},include:{application:!0,vacancies:!0}}).finally(()=>{i.Z.$disconnect()});return a?(e.user={id:a.id,email:a.email,name:a.name,surname:a.surname,role:a.Role,application:a.application,vacancies:a.vacancies},e):null}}}},23106:(e,t,a)=>{a.d(t,{Z:()=>r});let r=new(a(53524)).PrismaClient}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[431,521,123,206],()=>a(76559));module.exports=r})();